"use strict";(self.webpackChunkwhatsmymotivation=self.webpackChunkwhatsmymotivation||[]).push([[297],{297:(P,f,r)=>{r.r(f),r.d(f,{default:()=>E});var I,s,v,a,m,p,g=r(467),y=r(494),C=(r(170),Object.defineProperty),_=(t,e,i)=>(((t,e,i)=>{e in t?C(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i),R=(t,e,i)=>{if(!e.has(t))throw TypeError("Cannot "+i)},o=(t,e,i)=>(R(t,e,"read from private field"),i?i.call(t):e.get(t)),h=(t,e,i)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},u=(t,e,i,n)=>(R(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i),c=(t,e,i,n)=>({set _(d){u(t,e,d,i)},get _(){return o(t,e,n)}});class E{constructor(e){_(this,"config"),h(this,I,void 0),_(this,"initialized",!1),h(this,s,{}),h(this,v,0),h(this,a,0),h(this,m,[]),h(this,p,void 0),_(this,"noop",()=>{}),this.onInitComplete=e.onInitComplete||this.noop,this.onThemeLoaded=e.onThemeLoaded||this.noop,this.onRollResult=e.onRollResult||this.noop,this.onRollComplete=e.onRollComplete||this.noop,this.onDieRemoved=e.onDieRemoved||this.noop,this.initialized=this.initScene(e)}initScene(e){var i=this;return(0,g.A)(function*(){i.config=e.options,i.onInitComplete()})()}resize(){}loadTheme(){return Promise.resolve()}updateConfig(e){Object.assign(this.config,e)}addNonDie(e){console.log("die",e),clearTimeout(o(this,p));const{id:i,value:n,...d}=e,l={id:i,value:n,config:d};o(this,s)[i]=l,o(this,m).push(setTimeout(()=>{this.handleAsleep(l)},c(this,v)._++*this.config.delay)),u(this,p,setTimeout(()=>{this.onRollComplete()},500))}add(e){console.log("add die"),this.addNonDie(e)}remove(e){console.log("remove die");const i=o(this,s)[e.id];i.hasOwnProperty("d10Instance")&&(delete o(this,s)[i.d10Instance.id],c(this,a)._--),delete o(this,s)[e.id],c(this,a)._--,this.onDieRemoved(e.rollId)}clear(){!Object.keys(o(this,s)).length&&!o(this,a)||(o(this,m).forEach(e=>clearTimeout(e)),Object.values(o(this,s)).forEach(e=>{e.mesh&&e.mesh.dispose()}),u(this,s,{}),u(this,v,0),u(this,a,0))}handleAsleep(e){var i=this;return(0,g.A)(function*(){var n,d;if(e.asleep=!0,yield y.D.getRollResult(e),e.d10Instance||e.dieParent){if(null!=(n=e?.d10Instance)&&n.asleep||null!=(d=e?.dieParent)&&d.asleep){const l=100===e.config.sides?e:e.dieParent,w=10===e.config.sides?e:e.d10Instance;l.value=0===w.value&&0===l.value?100:l.value+w.value,i.onRollResult({rollId:l.config.rollId,value:l.value})}}else 10===e.config.sides&&0===e.value&&(e.value=10),i.onRollResult({rollId:e.config.rollId,value:e.value});c(i,a)._++})()}}I=new WeakMap,s=new WeakMap,v=new WeakMap,a=new WeakMap,m=new WeakMap,p=new WeakMap}}]);